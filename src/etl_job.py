import sys
from awsglue.transforms import *
from awsglue.utils import getResolvedOptions
from pyspark.context import SparkContext
from awsglue.context import GlueContext
from awsglue.job import Job
from awsglue import DynamicFrame

args = getResolvedOptions(sys.argv, ['JOB_NAME'])
sc = SparkContext()
glueContext = GlueContext(sc)
spark = glueContext.spark_session
job = Job(glueContext)
job.init(args['JOB_NAME'], args)

# Script generated for node Amazon S3
AmazonS3_node1753690898998 = glueContext.create_dynamic_frame.from_catalog(database="incremental_load_db", table_name="source_bucket_3123213", transformation_ctx="AmazonS3_node1753690898998")

# Script generated for node Amazon Redshift
AmazonRedshift_node1753690903898 = glueContext.write_dynamic_frame.from_options(frame=AmazonS3_node1753690898998, connection_type="redshift", connection_options={"postactions": "BEGIN; MERGE INTO public.crime_statistics USING public.crime_statistics_temp_mx8td7 ON crime_statistics.col0 = crime_statistics_temp_mx8td7.col0 WHEN MATCHED THEN UPDATE SET col0 = crime_statistics_temp_mx8td7.col0, col1 = crime_statistics_temp_mx8td7.col1, col2 = crime_statistics_temp_mx8td7.col2, col3 = crime_statistics_temp_mx8td7.col3, col4 = crime_statistics_temp_mx8td7.col4, col5 = crime_statistics_temp_mx8td7.col5, col6 = crime_statistics_temp_mx8td7.col6, col7 = crime_statistics_temp_mx8td7.col7, col8 = crime_statistics_temp_mx8td7.col8, col9 = crime_statistics_temp_mx8td7.col9, col10 = crime_statistics_temp_mx8td7.col10, col11 = crime_statistics_temp_mx8td7.col11, col12 = crime_statistics_temp_mx8td7.col12, col13 = crime_statistics_temp_mx8td7.col13, col14 = crime_statistics_temp_mx8td7.col14, col15 = crime_statistics_temp_mx8td7.col15, col16 = crime_statistics_temp_mx8td7.col16, col17 = crime_statistics_temp_mx8td7.col17, col18 = crime_statistics_temp_mx8td7.col18, col19 = crime_statistics_temp_mx8td7.col19, col20 = crime_statistics_temp_mx8td7.col20, col21 = crime_statistics_temp_mx8td7.col21, col22 = crime_statistics_temp_mx8td7.col22, col23 = crime_statistics_temp_mx8td7.col23, col24 = crime_statistics_temp_mx8td7.col24, col25 = crime_statistics_temp_mx8td7.col25, col26 = crime_statistics_temp_mx8td7.col26, col27 = crime_statistics_temp_mx8td7.col27, col28 = crime_statistics_temp_mx8td7.col28, col29 = crime_statistics_temp_mx8td7.col29, col30 = crime_statistics_temp_mx8td7.col30, col31 = crime_statistics_temp_mx8td7.col31, col32 = crime_statistics_temp_mx8td7.col32, col33 = crime_statistics_temp_mx8td7.col33, col34 = crime_statistics_temp_mx8td7.col34, col35 = crime_statistics_temp_mx8td7.col35, col36 = crime_statistics_temp_mx8td7.col36, col37 = crime_statistics_temp_mx8td7.col37, col38 = crime_statistics_temp_mx8td7.col38, col39 = crime_statistics_temp_mx8td7.col39, col40 = crime_statistics_temp_mx8td7.col40, col41 = crime_statistics_temp_mx8td7.col41, col42 = crime_statistics_temp_mx8td7.col42, col43 = crime_statistics_temp_mx8td7.col43, col44 = crime_statistics_temp_mx8td7.col44, col45 = crime_statistics_temp_mx8td7.col45, col46 = crime_statistics_temp_mx8td7.col46, col47 = crime_statistics_temp_mx8td7.col47, col48 = crime_statistics_temp_mx8td7.col48, col49 = crime_statistics_temp_mx8td7.col49, col50 = crime_statistics_temp_mx8td7.col50, col51 = crime_statistics_temp_mx8td7.col51, col52 = crime_statistics_temp_mx8td7.col52, col53 = crime_statistics_temp_mx8td7.col53, col54 = crime_statistics_temp_mx8td7.col54, col55 = crime_statistics_temp_mx8td7.col55, col56 = crime_statistics_temp_mx8td7.col56, col57 = crime_statistics_temp_mx8td7.col57, col58 = crime_statistics_temp_mx8td7.col58, col59 = crime_statistics_temp_mx8td7.col59, col60 = crime_statistics_temp_mx8td7.col60, col61 = crime_statistics_temp_mx8td7.col61, col62 = crime_statistics_temp_mx8td7.col62, col63 = crime_statistics_temp_mx8td7.col63, col64 = crime_statistics_temp_mx8td7.col64, col65 = crime_statistics_temp_mx8td7.col65, col66 = crime_statistics_temp_mx8td7.col66, col67 = crime_statistics_temp_mx8td7.col67 WHEN NOT MATCHED THEN INSERT VALUES (crime_statistics_temp_mx8td7.col0, crime_statistics_temp_mx8td7.col1, crime_statistics_temp_mx8td7.col2, crime_statistics_temp_mx8td7.col3, crime_statistics_temp_mx8td7.col4, crime_statistics_temp_mx8td7.col5, crime_statistics_temp_mx8td7.col6, crime_statistics_temp_mx8td7.col7, crime_statistics_temp_mx8td7.col8, crime_statistics_temp_mx8td7.col9, crime_statistics_temp_mx8td7.col10, crime_statistics_temp_mx8td7.col11, crime_statistics_temp_mx8td7.col12, crime_statistics_temp_mx8td7.col13, crime_statistics_temp_mx8td7.col14, crime_statistics_temp_mx8td7.col15, crime_statistics_temp_mx8td7.col16, crime_statistics_temp_mx8td7.col17, crime_statistics_temp_mx8td7.col18, crime_statistics_temp_mx8td7.col19, crime_statistics_temp_mx8td7.col20, crime_statistics_temp_mx8td7.col21, crime_statistics_temp_mx8td7.col22, crime_statistics_temp_mx8td7.col23, crime_statistics_temp_mx8td7.col24, crime_statistics_temp_mx8td7.col25, crime_statistics_temp_mx8td7.col26, crime_statistics_temp_mx8td7.col27, crime_statistics_temp_mx8td7.col28, crime_statistics_temp_mx8td7.col29, crime_statistics_temp_mx8td7.col30, crime_statistics_temp_mx8td7.col31, crime_statistics_temp_mx8td7.col32, crime_statistics_temp_mx8td7.col33, crime_statistics_temp_mx8td7.col34, crime_statistics_temp_mx8td7.col35, crime_statistics_temp_mx8td7.col36, crime_statistics_temp_mx8td7.col37, crime_statistics_temp_mx8td7.col38, crime_statistics_temp_mx8td7.col39, crime_statistics_temp_mx8td7.col40, crime_statistics_temp_mx8td7.col41, crime_statistics_temp_mx8td7.col42, crime_statistics_temp_mx8td7.col43, crime_statistics_temp_mx8td7.col44, crime_statistics_temp_mx8td7.col45, crime_statistics_temp_mx8td7.col46, crime_statistics_temp_mx8td7.col47, crime_statistics_temp_mx8td7.col48, crime_statistics_temp_mx8td7.col49, crime_statistics_temp_mx8td7.col50, crime_statistics_temp_mx8td7.col51, crime_statistics_temp_mx8td7.col52, crime_statistics_temp_mx8td7.col53, crime_statistics_temp_mx8td7.col54, crime_statistics_temp_mx8td7.col55, crime_statistics_temp_mx8td7.col56, crime_statistics_temp_mx8td7.col57, crime_statistics_temp_mx8td7.col58, crime_statistics_temp_mx8td7.col59, crime_statistics_temp_mx8td7.col60, crime_statistics_temp_mx8td7.col61, crime_statistics_temp_mx8td7.col62, crime_statistics_temp_mx8td7.col63, crime_statistics_temp_mx8td7.col64, crime_statistics_temp_mx8td7.col65, crime_statistics_temp_mx8td7.col66, crime_statistics_temp_mx8td7.col67); DROP TABLE public.crime_statistics_temp_mx8td7; END;", "redshiftTmpDir": "s3://aws-glue-assets-577638377048-us-east-1/temporary/", "useConnectionProperties": "true", "dbtable": "public.crime_statistics_temp_mx8td7", "connectionName": "Redshift connection", "preactions": "CREATE TABLE IF NOT EXISTS public.crime_statistics (col0 BIGINT, col1 VARCHAR, col2 VARCHAR, col3 VARCHAR, col4 VARCHAR, col5 VARCHAR, col6 VARCHAR, col7 VARCHAR, col8 VARCHAR, col9 VARCHAR, col10 VARCHAR, col11 VARCHAR, col12 VARCHAR, col13 VARCHAR, col14 VARCHAR, col15 VARCHAR, col16 VARCHAR, col17 VARCHAR, col18 VARCHAR, col19 VARCHAR, col20 VARCHAR, col21 VARCHAR, col22 VARCHAR, col23 VARCHAR, col24 VARCHAR, col25 VARCHAR, col26 VARCHAR, col27 VARCHAR, col28 VARCHAR, col29 VARCHAR, col30 VARCHAR, col31 VARCHAR, col32 VARCHAR, col33 VARCHAR, col34 VARCHAR, col35 VARCHAR, col36 VARCHAR, col37 VARCHAR, col38 VARCHAR, col39 VARCHAR, col40 VARCHAR, col41 VARCHAR, col42 VARCHAR, col43 VARCHAR, col44 VARCHAR, col45 VARCHAR, col46 VARCHAR, col47 VARCHAR, col48 VARCHAR, col49 VARCHAR, col50 VARCHAR, col51 VARCHAR, col52 VARCHAR, col53 VARCHAR, col54 VARCHAR, col55 VARCHAR, col56 VARCHAR, col57 VARCHAR, col58 VARCHAR, col59 VARCHAR, col60 VARCHAR, col61 VARCHAR, col62 VARCHAR, col63 VARCHAR, col64 VARCHAR, col65 VARCHAR, col66 VARCHAR, col67 VARCHAR); DROP TABLE IF EXISTS public.crime_statistics_temp_mx8td7; CREATE TABLE public.crime_statistics_temp_mx8td7 (col0 BIGINT, col1 VARCHAR, col2 VARCHAR, col3 VARCHAR, col4 VARCHAR, col5 VARCHAR, col6 VARCHAR, col7 VARCHAR, col8 VARCHAR, col9 VARCHAR, col10 VARCHAR, col11 VARCHAR, col12 VARCHAR, col13 VARCHAR, col14 VARCHAR, col15 VARCHAR, col16 VARCHAR, col17 VARCHAR, col18 VARCHAR, col19 VARCHAR, col20 VARCHAR, col21 VARCHAR, col22 VARCHAR, col23 VARCHAR, col24 VARCHAR, col25 VARCHAR, col26 VARCHAR, col27 VARCHAR, col28 VARCHAR, col29 VARCHAR, col30 VARCHAR, col31 VARCHAR, col32 VARCHAR, col33 VARCHAR, col34 VARCHAR, col35 VARCHAR, col36 VARCHAR, col37 VARCHAR, col38 VARCHAR, col39 VARCHAR, col40 VARCHAR, col41 VARCHAR, col42 VARCHAR, col43 VARCHAR, col44 VARCHAR, col45 VARCHAR, col46 VARCHAR, col47 VARCHAR, col48 VARCHAR, col49 VARCHAR, col50 VARCHAR, col51 VARCHAR, col52 VARCHAR, col53 VARCHAR, col54 VARCHAR, col55 VARCHAR, col56 VARCHAR, col57 VARCHAR, col58 VARCHAR, col59 VARCHAR, col60 VARCHAR, col61 VARCHAR, col62 VARCHAR, col63 VARCHAR, col64 VARCHAR, col65 VARCHAR, col66 VARCHAR, col67 VARCHAR);"}, transformation_ctx="AmazonRedshift_node1753690903898")

job.commit()